var html5QrCode,lastCode="",submitOk=!1;function onScanSuccess(e,t){e!=lastCode&&(checkMaterialCode(lastCode=e),""==$("#quantity").val()&&$("#received").val())}function checkMaterialCode(t){t.length<2||$.ajax({url:"/api/inventory/checkMaterialCode",type:"POST",data:{code:t,api_token:"{{ Auth::user()->api_token }}"},success:function(e){e.success?($("#msg").html(`Found Chemical ${e.material.VendorCode} - `+e.material.ChemcoName),$("#code").val(""+e.material.VendorCode),$("#chemid").val(""+e.material.id),submitOk=1,$("#code").focus(),$("#quantity").focus(),$("#msgcolor").css("background-color","#3cb043")):(submitOk=0,$("#msg").html(`Chemical ${t} not found`),$("#msgcolor").css("background-color","#D0312d"))}})}var pause=!1;function submitForm(){var e,t,o,a;submitOk?pause||(pause=!0,e=$("#quantity").val(),t=$("#received").val(),o=$("#chemid").val(),a=$("#plant").val(),$.ajax({url:"/inventory/postInventory",type:"POST",data:{quantity:e,received:t,chemid:o,plant:a,api_token:"{{ Auth::user()->api_token }}"},success:function(e){pause=!1,e.success&&($("#msg").html("Inventory Submitted"),$("#code").val(""),$("#quantity").val(""),$("#received").val(""),$("#quantity").focus())}})):$("#msg").html("Invalid Chemical ID")}$(function(){setupAjaxToken(),$("#sbmit").click(submitForm),$("#code").keyup(function(){console.log("keyup"),checkMaterialCode($("#code").val())});Html5QrcodeSupportedFormats.QR_CODE,Html5QrcodeSupportedFormats.UPC_A,Html5QrcodeSupportedFormats.UPC_E,Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION,Html5QrcodeSupportedFormats.CODE_39,Html5QrcodeSupportedFormats.CODE_128;(html5QrCode=new Html5Qrcode("reader",{experimentalFeatures:{useBarCodeDetectorIfSupported:!0}})).start({facingMode:"environment"},{fps:10},onScanSuccess)});
